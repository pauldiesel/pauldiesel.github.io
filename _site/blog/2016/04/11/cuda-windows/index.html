<!DOCTYPE HTML><html><head><meta charset="utf-8" /><link rel="apple-touch-icon" sizes="76x76" href="http://localhost:4000/assets/img/apple-icon.png"><link rel="icon" type="image/png" href="http://localhost:4000/assets/img/favicon.png"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><title>GPU accelerated computing on Windows 10 (Theano & Keras)</title><meta name="description" content="There are a ton of resources out there to help with setting up your deep learning machine with linux. There is hardly any material available for Windows 10 machines and those that are available are outdated. I have gone through the pain of sifting through various blogs and other sites to get my setup running and wanted to share it with you guys." /><meta name="author" content="M Reddy" /><meta name="viewport" content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' /><meta name="keywords" content="machine-learning,windows,cuda,gpu,Arcane, Reveries, Manikanta" /><meta name="msvalidate.01" content="74C35086502D0044BAD289F68057B30D" /><!-- Fonts and icons --><link rel="canonical" href="http://localhost:4000/blog/2016/04/11/cuda-windows/" /><link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" /><link rel="stylesheet" href="http://localhost:4000/assets/stylesheets/font-awesome.min.css" /><link href="https://fonts.googleapis.com/css?family=Comfortaa" rel="stylesheet"><!-- CSS Files --><link href="http://localhost:4000/assets/stylesheets/prism.css" rel="stylesheet" /><link href="http://localhost:4000/assets/stylesheets/application.css" rel="stylesheet" /> <script>var siteUrl = "http://localhost:4000"; var pageUrl = "/blog/2016/04/11/cuda-windows/"</script><!-- Open Graph Meta Tags --><meta property="og:url" content="http://localhost:4000/blog/2016/04/11/cuda-windows/" /><meta property="og:type" content="article" /><meta property="og:title" content="GPU accelerated computing on Windows 10 (Theano & Keras)" /><meta property="og:description" content="There are a ton of resources out there to help with setting up your deep learning machine with linux. There is hardly any material available for Windows 10 machines and those that are available are outdated. I have gone through the pain of sifting through various blogs and other sites to get my setup running and wanted to share it with you guys." /><meta property="og:image" content="http://localhost:4000/assets/img/blog.jpg" /><meta property="og:image:alt" content="GPU accelerated computing on Windows 10 (Theano & Keras)" /><!-- Facebook Tags --><meta property="fb:app_id" content="1974458362838018" /><!-- Twitter Tags --><meta name="twitter:card" content="summary" /><meta name="twitter:creator" content="@ManikantaReddyD" /><meta name="twitter:site" content="@ManikantaReddyD" /><meta name="twitter:title" content="GPU accelerated computing on Windows 10 (Theano & Keras)" /><meta name="twitter:description" content="There are a ton of resources out there to help with setting up your deep learning machine with linux. There is hardly any material available for Windows 10 machines and those that are available are outdated. I have gone through the pain of sifting through various blogs and other sites to get my setup running and wanted to share it with you guys." /><meta name="twitter:image" content="http://localhost:4000" /><!-- Google Data --> <script type="application/ld+json"> { "@context": "https://schema.org", "@type": "Article", "mainEntityOfPage": { "@type": "WebPage", "@id": "http://localhost:4000/blog/2016/04/11/cuda-windows/" }, "headline": "GPU accelerated computing on Windows 10 (Theano & Keras)", "image": [ "http://localhost:4000" ], "datePublished": "2016-04-11 00:00:00 -0400", "publisher":{ "@type": "Organization", "name": "Arcane Reveries", "logo": { "@type": "ImageObject", "url": "http://localhost:4000/favicon.png" } }, "author": { "@type": "Person", "name": "M Reddy", "sameAs": [ "mailto:manikanta.reddy.d@outlook.com", "https://twitter.com/ManikantaReddyD", "https://facebook.com/Manikanta.D.Reddy", "https://linkedin.com/in/ManikantaDReddy", "https://github.com/ManikantaReddyD", "https://stackoverflow.com/users/6345500/manikanta-reddy-d", "https://www.last.fm/user/ManikantaReddy", "https://soundcloud.com/ManikantaReddyD", "https://open.spotify.com/user/12185478274", "https://www.reddit.com/user/ManikantaReddyD", "skype:manikanta.reddy.d?chat", "" ] }, "description": "There are a ton of resources out there to help with setting up your deep learning machine with linux. There is hardly any material available for Windows 10 machines and those that are available are outdated. I have gone through the pain of sifting through various blogs and other sites to get my setup running and wanted to share it with you guys." } </script><body class="index-page"><nav class="navbar navbar-transparent navbar-fixed-top navbar-color-on-scroll"><div class="container"><div class="navbar-header"> <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-index"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a href="http://localhost:4000/"><div class="logo-container" style="padding-left: 12px"><div class="logo"> <img src="http://localhost:4000/assets/img/logo.jpg" alt="Manikanta Reddy D" rel="tooltip" title="Hello! Its Me." data-placement="bottom" data-html="true"></div><div class="logo-brand"> Arcane Reveries</div></div></a></div><div class="collapse navbar-collapse" id="navigation-index"><ul class="nav navbar-nav navbar-right"><li> <a href="http://localhost:4000/about"> <i class="material-icons">account_circle</i> About </a><li> <a href="http://localhost:4000/blog"> <i class="material-icons">dashboard</i> Posts </a><li> <a href="http://localhost:4000/tags"> <i class="fa fa-tag"></i> Tags </a></ul></div></div></nav><div class="wrapper"><div class="header header-filter" ><div class="container" style=" background-image: url('http://localhost:4000/assets/img/blog.jpg'); width:100%; background-position: center; " ><div class="row" style=" background: rgba(39,62,84,0.82); overflow: hidden; height: 100%; z-index: 500; " ><div class="col-md-8 col-md-offset-2"><div class="brand"><h1>GPU accelerated computing on Windows 10 (Theano & Keras)</h1><h3></h3></div></div></div></div></div><div class="main"><div class="section"><div class="container"><div class="col-md-10 col-lg-offset-1" style="font-family: 'Comfortaa'"><blockquote><p>There are a ton of resources out there to help with setting up your deep learning machine with linux. There is hardly any material available for Windows 10 machines and those that are available are outdated. I have gone through the pain of sifting through various blogs and other sites to get my setup running and wanted to share it with you guys.</blockquote><div class="row"><p class="col-md-6">11 April 2016<p class="col-md-6">Reading time ~4 minutes</div><div style="overflow: hidden;"><div class="tags" style="white-space: nowrap; overflow-x: auto; overflow-y:hidden; width: 100%; height: 50px"> <button class="btn btn-simple btn-primary" style="padding: 5px;"><a href="http://localhost:4000/tags/machine-learning" class="">machine-learning</a></button> <button class="btn btn-simple btn-primary" style="padding: 5px;"><a href="http://localhost:4000/tags/windows" class="">windows</a></button> <button class="btn btn-simple btn-primary" style="padding: 5px;"><a href="http://localhost:4000/tags/cuda" class="">cuda</a></button> <button class="btn btn-simple btn-primary" style="padding: 5px;"><a href="http://localhost:4000/tags/gpu" class="">gpu</a></button></div></div><hr /><h2 id="why">Why?</h2><p>The first question that comes to your mind is definitely, why is this guy even trying to do serious stuff on a Windows machine? Well I’ve my reasons. I was recently trying to build a convolution neural network to segment some ultra sound images for identifying nerves! Naturally I had to choose gpu based computation for training. I picked up the Keras + Theano combo for my purposes (I could have gone with tensorflow too!). But soon as fate had it for me, setting up the gpu (NVIDIA 950M) drivers on Ubuntu <em>for my device</em> was traumatizing. Every time I installed the nvidia drivers, my display bloke. I was forced to stare at blank screens, doing nothing. I headed to countless forums for help, but as it turns out my problem was a bit device specific and probably there wasn’t a solution but to not install nvidia drivers. So I had to explore other options.<p>Luckily I tried installing cuda development kit on windows and it didn’t break it. So I decided to bring the rest of the setup to the same platform.<p>In case you are compelled to run a deep learning setup on a Windows 10 64-bit Machine, this guide might positively help you. If you need any other help, do comment below.<hr /><h1 id="guide-to-install-deep-learning-setup-on-windows-10">Guide to Install Deep Learning Setup on Windows 10</h1><h2 id="installing-cuda">Installing CUDA</h2><p>Download cuda 7.5 from NVIDIA <a href="https://developer.nvidia.com/cuda-downloads">here</a>. Choose the <em>local</em> installer and run it.<p>Cuda will now install to <code class="highlighter-rouge">C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v7.5</code><ul><li>Make sure that the following two are added to <strong>system path</strong> (Not the user path)<ul><li><code class="highlighter-rouge">C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v7.5\libnwp</code><li><code class="highlighter-rouge">C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v7.5\bin</code></ul><li>It is important that they are added to the <strong>system path</strong> not the user path.</ul><p>At this stage you might be get a warning that looks like<p><img src="http://localhost:4000/assets/posts/2016-09-21-cuda-windows/cuda-needs-vs2013.png" alt="" /><p>or<p><img src="http://localhost:4000/assets/posts/2016-09-21-cuda-windows/cuda-needs-vs2013-2.png" alt="" /><p>Do not check the box and click continue.<p>Turns out cuda needs visual studio compilers. Specifically it needs the compilers from Visual Studio 2013. I already had Visual Studio 2015 installed but cuda installer didn’t bat an eye.<p>In order to successfully install cuda you’ll need visual studio 2013 and you can grab the free community edition <a href="https://www.visualstudio.com/en-us/news/vs2013-community-vs.aspx">here</a>. Visual Studio takes some time to install, please have some patience.<p>After installing Visual Studio 2013 remember to add this to <em>system path</em> <code class="highlighter-rouge">C:\Program Files (x86)\Microsoft Visual Studio 12.0\VC\bin</code><p>You should by now have cuda installed successfully.<h2 id="mingw64">MINGW64</h2><p>We’ll now need a complete runtime environment for gcc to support binaries native to Windows 64-bit and 32-bit operating systems. MINGW64 is the right fit for out job. Download MinGW-w64 from <a href="https://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/Personal%20Builds/mingw-builds/">here</a><p>Run the installer with the following setup. <img src="http://localhost:4000/assets/posts/2016-09-21-cuda-windows/mingw-setup2.png" alt="" /> It is important that architecture is set to x86_64 and the version is 5.3.0. Remember the path, where you installed it.<p>Now add <code class="highlighter-rouge">INSTALLATION PATH\mingw64\bin</code> to <strong>system path</strong><p>Also rename the <code class="highlighter-rouge">mingw32</code> to <code class="highlighter-rouge">mingw32-back</code> as the 32 bit binaries compete with the 64 bit binaries.<p>You can test your installation of <code class="highlighter-rouge">MinGW</code> using the following…<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>where gcc; where g++; where cl; where nvcc; where cudafe; where cudafe++
<span class="gp">$ </span>gcc --version; g++ --version
<span class="gp">$ </span>cl
<span class="gp">$ </span>nvcc --version; cudafe --version; cudafe++ --version
</code></pre></div><h2 id="theano">Theano</h2><p>I installed <code class="highlighter-rouge">Theano 0.8.2</code> on my machine, I haven’t tested the installation neither with other versions of Theano nor other machines. You might be in luck, just try these steps. Install the stable version of <code class="highlighter-rouge">Theano 0.8.2</code> from github<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>git clone https://github.com/Theano/Theano.git theano-0.8.2 --branch rel-0.8.2
<span class="gp">$ </span>python setup.py install 
</code></pre></div><p>Check if Ananconda registered it,<div class="language-shell highlighter-rouge"><pre class="highlight"><code>conda list | grep -i theano
</code></pre></div><h2 id="openblas-0214-optional">OpenBLAS 0.2.14 (Optional)</h2><p>We are going to perform GPU based computations, so why stick to <em>CPU optimized</em> libraries? In practice, however, many operations are often executed in parallel on the CPU while the GPU is busy learning the weights of the deep neural network and the augmented data discarded after use. For this reason, it is highly recommend installing the OpenBLAS library.<p>According to the <a href="https://deeplearning.net/software/theano_versions/dev/install_windows.html#install-windows">Theano</a> documentation, the multi-threaded <a href="https://en.wikipedia.org/wiki/OpenBLAS">OpenBLAS</a> library performs much better than the un-optimized standard BLAS (Basic Linear Algebra Subprograms) library, so that’s what we use.<p>Download OpenBLAS from <a href="https://sourceforge.net/projects/openblas/files/v0.2.14/OpenBLAS-v0.2.14-Win64-int32.zip/download">here</a> and extract the files to <strong>OPENBLAS DIR</strong><ul><li>Add <code class="highlighter-rouge">**OPENBLAS DIR**\bin</code> to <code class="highlighter-rouge">PATH</code></ul><h2 id="using-cpu-and-gpu">Using CPU and GPU</h2><p>Add these lines to the top of your python code to start using the GPU mode, simply uncomment them to switch to CPU mode<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'KERAS_BACKEND'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'theano'</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'THEANO_FLAGS'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'floatX=float32,device=gpu,lib.cnmem=0.8,dnn.conv.algo_bwd_filter=deterministic,dnn.conv.algo_bwd_data=deterministic,blas.ldflags=-LC:**OPENBLAS DIR**/bin -lopenblas'</span>
</code></pre></div><p><strong>OPENBLAS DIR</strong> is where you installed OpenBLAS.<p>Your keras model should now be using the GPU!<h2 id="optional">Optional</h2><p>You could definitely install <code class="highlighter-rouge">cuDNN</code> to further accelrate your performance, but that’ll be a post for later.<hr /><div class="row comments animated fadeInUp"><h3>Comments</h3><button id="show-comments" class="btn btn-primary">Load comments</button><div id="comments-spinner" style="display: none;"><!--<div class="spinner"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>--><div style="text-align: center;"> <svg width="33%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-infinity"><path fill="none" ng-attr-stroke="" ng-attr-stroke-width="" ng-attr-stroke-dasharray="" d="M24.3,30C11.4,30,5,43.3,5,50s6.4,20,19.3,20c19.3,0,32.1-40,51.4-40 C88.6,30,95,43.3,95,50s-6.4,20-19.3,20C56.4,70,43.6,30,24.3,30z" stroke="#03a9f4" stroke-width="1" stroke-dasharray="6.414723205566406 6.414723205566406"> <animate attributeName="stroke-dashoffset" calcMode="linear" values="0;256.58892822265625" keyTimes="0;1" dur="5" begin="0s" repeatCount="indefinite"></animate> </path> </svg></div></div><div id="comments" style="display: none;"><ul class="nav nav-pills"><li class="active"><a data-toggle="tab" href="#fb_comments">Facebook</a><li><a data-toggle="tab" href="#disqus_comments">Disqus</a></ul><hr /><div class="tab-content"><div id="fb_comments" class="tab-pane active"><div class="fb-comments" data-href="http://localhost:4000/blog/2016/04/11/cuda-windows/" data-colorscheme="light" data-num-posts="4" data-width="100%"></div></div><div id="disqus_comments" class="tab-pane"><div id="disqus_thread"></div></div></div></div></div><h2 style="text-align: center;">More Posts</h2><div class="row"><div class="col-md-6"><div class="card card-raised"><div class="card-image" style="background-image: url('/assets/posts/2016-09-26-criticism-against-rosenkrantz-example-against-nicod/feature.png'); "></div><div class="content"> <a href="http://localhost:4000/blog/2016/09/26/criticism-against-rosenkrantz-example-against-nicod/"><h3>Criticism against counter example by Rosenkrantz against Instance Confirmation</h3></a><div class="row"><p class="col-md-6">26 September 2016<p class="col-md-6">Reading time ~5 minutes</div><p>Nicod's criterion is one of the fundamental concepts of the theory of confirmation. It is also center to the famous 'Raven Paradox', and attempts have been made to debunk it. One such counter examp...</div><div class="tags content-bottom"> <button class="btn btn-simple btn-primary" style="padding: 5px;"><a href="http://localhost:4000/tags/philosophy" class="">philosophy</a></button> <button class="btn btn-simple btn-primary" style="padding: 5px;"><a href="http://localhost:4000/tags/instance-confirmation" class="">instance-confirmation</a></button> <button class="btn btn-simple btn-primary" style="padding: 5px;"><a href="http://localhost:4000/tags/confirmation-theory" class="">confirmation-theory</a></button></div></div></div><div class="col-md-6"><div class="card card-raised"><div class="card-image" style="background-image: url('/assets/posts/2016-04-11-cats-or-dogs/feature.jpg'); "></div><div class="content"> <a href="http://localhost:4000/blog/2016/04/11/cats-or-dogs/"><h3>Cats or Dogs</h3></a><div class="row"><p class="col-md-6">11 April 2016<p class="col-md-6">Reading time ~4 minutes</div><p>In this experiment we'll train a machine to distinguish between cats and dogs. We'll be using Support vector machines for the same.</div><div class="tags content-bottom"> <button class="btn btn-simple btn-primary" style="padding: 5px;"><a href="http://localhost:4000/tags/ai" class="">ai</a></button> <button class="btn btn-simple btn-primary" style="padding: 5px;"><a href="http://localhost:4000/tags/machine-learning" class="">machine-learning</a></button> <button class="btn btn-simple btn-primary" style="padding: 5px;"><a href="http://localhost:4000/tags/binary-classification" class="">binary-classification</a></button> <button class="btn btn-simple btn-primary" style="padding: 5px;"><a href="http://localhost:4000/tags/random-forests" class="">random-forests</a></button></div></div></div></div></div></div></div></div></div><!-- Core JS Files --> <script src="http://localhost:4000/assets/javascripts/vendors/jquery.min.js" type="text/javascript"></script> <script src="http://localhost:4000/assets/javascripts/vendors/material-kit/bootstrap.min.js" type="text/javascript"></script> <script src="http://localhost:4000/assets/javascripts/vendors/material-kit/material.min.js"></script><!-- <script src="http://localhost:4000/assets/javascripts/vendors/material-kit/nouislider.min.js" type="text/javascript"></script> --> <script src="http://localhost:4000/assets/javascripts/vendors/material-kit/bootstrap-datepicker.js" type="text/javascript"></script> <script src="http://localhost:4000/assets/javascripts/vendors/material-kit/material-kit.js" type="text/javascript"></script> <script src="http://localhost:4000/assets/javascripts/vendors/prism.js" type="text/javascript"></script><!-- <script type="text/javascript"> $().ready(function () { materialKit.initSliders(); window_width = $(window).width(); if (window_width >= 992) { big_image = $('.wrapper > .header'); $(window).on('scroll', materialKitDemo.checkScrollForParallax); } }); </script> --> <script type="text/javascript"> var load_disqus = function(){ var disqus_shortname = 'manikantadreddy'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); }; </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><div id="fb-root"></div><script> var load_facebook = function(){ (function (d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5&appId=1166944040038372"; fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk')); }; </script> <script src="http://localhost:4000/assets/javascripts/comments.js"></script> <script> $(document).on('click', 'a[href^="#"]', function (event) { event.preventDefault(); $('html, body').animate({ scrollTop: $($.attr(this, 'href')).offset().top -150 }, 500); }); </script>
    